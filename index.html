<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pro Hayatta Kalma Arenası</title>
    
    <style>
        body {
            font-family: 'Consolas', monospace;
            margin: 0;
            padding: 0;
            background-color: #121212;
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            user-select: none;
        }

        #oyunAlani {
            border: 3px solid #6200EE; /* Mor çerçeve */
            background-color: #000;
            touch-action: none;
            box-shadow: 0 0 20px rgba(98, 0, 238, 0.5);
        }

        .kontrol-paneli {
            width: 300px;
            margin-bottom: 10px;
            padding: 10px;
            background: #222;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            font-size: 1.2em;
        }

        #mesaj {
            color: #BB86FC; /* Açık mor */
            font-weight: bold;
            margin-top: 15px;
        }
        
        button {
            padding: 12px 25px;
            background-color: #03DAC5; /* Turkuaz */
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            margin-top: 15px;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        
        button:active {
            background-color: #018786;
        }
    </style>
</head>
<body>

    <div class="kontrol-paneli">
        <span>SKOR: <span id="oyuncuSkor">0</span></span>
        <span>SEVİYE: <span id="seviyeGosterge">1</span></span>
    </div>

    <canvas id="oyunAlani" width="300" height="500"></canvas>
    
    <button id="baslatDugmesi">ARENAYA GİR</button>

    <div id="mesaj">Hayatta kal ve skor topla!</div>

    <script>
        // === HTML5 CANVAS VE OYUN AYARLARI ===
        const canvas = document.getElementById('oyunAlani');
        const ctx = canvas.getContext('2d');
        const oyuncuSkorElement = document.getElementById('oyuncuSkor');
        const seviyeGostergeElement = document.getElementById('seviyeGosterge');
        const mesajElement = document.getElementById('mesaj');
        const baslatDugmesi = document.getElementById('baslatDugmesi');

        let oyunDurumu = 'hazir';
        let oyuncu = { x: canvas.width / 2, y: 450, boyut: 25, skor: 0, renk: '#03DAC5' }; // Turkuaz
        let nesneler = []; // Hem puan küpleri hem mayınlar
        let botRakipler = []; // Saldıran botlar
        
        let zorlukSeviyesi = 1;
        let puanSayaci = 0; // Seviye atlamak için toplanan puanı tutar
        const SEVIYE_GEREKSINIM = 10; // Her 10 puanda bir seviye atlanır

        // Nesne tipleri
        const TIP_PUAN = 'puan';
        const TIP_MAYIN = 'mayın';

        // === TEMEL OYUN FONKSİYONLARI ===

        function cizimTemizle() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function karakterCiz(karakter) {
            ctx.fillStyle = karakter.renk;
            // Basit animasyon: Karakteri hafifçe küçültüp büyütme
            const boyut = karakter.boyut * (1 + Math.sin(Date.now() / 300) * 0.05);
            ctx.fillRect(karakter.x - boyut / 2, karakter.y - boyut / 2, boyut, boyut);
        }

        function nesneCiz(nesne) {
            if (nesne.tip === TIP_PUAN) {
                ctx.fillStyle = '#4CAF50'; // Yeşil
                ctx.fillRect(nesne.x - nesne.boyut / 2, nesne.y - nesne.boyut / 2, nesne.boyut, nesne.boyut);
            } else if (nesne.tip === TIP_MAYIN) {
                ctx.fillStyle = '#FFC107'; // Sarı
                ctx.beginPath();
                ctx.arc(nesne.x, nesne.y, nesne.boyut, 0, Math.PI * 2);
                ctx.fill();
            } else if (nesne.tip === 'bot') {
                ctx.fillStyle = '#CF6679'; // Kırmızımsı
                ctx.fillRect(nesne.x - nesne.boyut / 2, nesne.y - nesne.boyut / 2, nesne.boyut, nesne.boyut);
                // Botlara göz gibi bir detay ekleyelim
                ctx.fillStyle = '#000';
                ctx.fillRect(nesne.x - 5, nesne.y - 5, 2, 2);
                ctx.fillRect(nesne.x + 3, nesne.y - 5, 2, 2);
            }
        }
        
        function rastgeleNesneYarat() {
            const x = Math.random() * (canvas.width - 40) + 20;
            const tip = Math.random() < 0.7 ? TIP_PUAN : TIP_MAYIN; // %70 Puan, %30 Mayın
            const boyut = tip === TIP_MAYIN ? 12 : 10;
            const hiz = Math.random() * (0.8 + zorlukSeviyesi * 0.3) + 1; // Zorluğa göre hızlanır

            nesneler.push({ x: x, y: 0, boyut: boyut, tip: tip, hiz: hiz });
        }

        function botYarat() {
            const x = Math.random() * (canvas.width - 40) + 20;
            const hiz = 1.5 + zorlukSeviyesi * 0.4; // Bot da zorluğa göre hızlanır
            botRakipler.push({ x: x, y: 0, boyut: 20, tip: 'bot', hiz: hiz });
        }
        
        function nesneleriGuncelle() {
            for (let i = 0; i < nesneler.length; i++) {
                nesneler[i].y += nesneler[i].hiz;

                if (nesneler[i].y > canvas.height) {
                    nesneler.splice(i, 1);
                    i--;
                }
            }
        }

        function botlariGuncelle() {
            for (let i = 0; i < botRakipler.length; i++) {
                const bot = botRakipler[i];
                
                // Bot, oyuncuya doğru hareket eder (Basit takip mantığı)
                if (bot.x < oyuncu.x) {
                    bot.x += bot.hiz * 0.5;
                } else if (bot.x > oyuncu.x) {
                    bot.x -= bot.hiz * 0.5;
                }
                
                // Botu aşağı doğru hareket ettir
                bot.y += bot.hiz;

                // Ekranın altından çıkan botları kaldır
                if (bot.y > canvas.height) {
                    botRakipler.splice(i, 1);
                    i--;
                }
            }
        }

        function carpismaKontrol(obj1, obj2) {
            const dx = obj1.x - obj2.x;
            const dy = obj1.y - obj2.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            return distance < (obj1.boyut / 2 + obj2.boyut);
        }

        function skorVeCarismaKontrol() {
            // Nesnelerle çarpışma
            for (let i = 0; i < nesneler.length; i++) {
                if (carpismaKontrol(oyuncu, nesneler[i])) {
                    const nesne = nesneler[i];
                    
                    if (nesne.tip === TIP_PUAN) {
                        oyuncu.skor += 10;
                        puanSayaci += 10;
                        oyuncuSkorElement.textContent = oyuncu.skor;
                    } else if (nesne.tip === TIP_MAYIN) {
                        oyunuBitir('Mayına Çarptın!');
                        return; 
                    }
                    
                    nesneler.splice(i, 1);
                    i--;
                }
            }
            
            // Botlarla çarpışma
            for (let i = 0; i < botRakipler.length; i++) {
                 if (carpismaKontrol(oyuncu, botRakipler[i])) {
                    oyunuBitir('Bot Rakibe Yakalandın!');
                    return; 
                }
            }

            // Seviye kontrolü
            if (puanSayaci >= SEVIYE_GEREKSINIM) {
                seviyeAtla();
            }
        }

        // === OYUN ZORLUK MANTIĞI ===
        function seviyeAtla() {
            zorlukSeviyesi++;
            puanSayaci = 0; // Sayacı sıfırla
            seviyeGostergeElement.textContent = zorlukSeviyesi;
            mesajElement.textContent = `SEVİYE ${zorlukSeviyesi} AKTİF! ZORLUK ARTTI.`;
        }


        // === MOBİL KONTROL (KAYDIRMA) ===
        function handleTouchMove(e) {
            if (oyunDurumu !== 'oynuyor') return;
            const touchX = e.touches[0].clientX;
            const rect = canvas.getBoundingClientRect();
            let newX = touchX - rect.left;
            
            // Karakteri ortala ve sınırları kontrol et
            oyuncu.x = Math.max(oyuncu.boyut / 2, Math.min(canvas.width - oyuncu.boyut / 2, newX));
            
            e.preventDefault(); 
        }

        canvas.addEventListener('touchmove', handleTouchMove, false);

        // === OYUN DÖNGÜSÜ ===
        let nesneSayac = 0;
        let botSayac = 0;

        function oyunCevrimi() {
            if (oyunDurumu !== 'oynuyor') return;

            // Nesne yaratma hızı: Zorluk arttıkça hızlanır
            nesneSayac++;
            if (nesneSayac % Math.max(30 - zorlukSeviyesi * 3, 10) === 0) {
                rastgeleNesneYarat();
            }
            
            // Bot yaratma hızı: Zorluk arttıkça daha sık bot gelir
            botSayac++;
            if (botSayac % Math.max(200 - zorlukSeviyesi * 20, 50) === 0) {
                botYarat();
            }


            cizimTemizle();
            
            nesneleriGuncelle();
            botlariGuncelle();
            skorVeCarismaKontrol();

            // Çizim
            nesneler.forEach(nesneCiz);
            botRakipler.forEach(bot => nesneCiz({...bot, tip: 'bot'})); // Botları çiz
            karakterCiz(oyuncu);
            

            requestAnimationFrame(oyunCevrimi);
        }
        
        // === OYUN BAŞLATMA VE BİTİRME ===
        
        function oyunuBaslat() {
            if (oyunDurumu === 'oynuyor') return;
            
            // Sıfırla
            oyuncu.skor = 0;
            puanSayaci = 0;
            zorlukSeviyesi = 1;
            nesneler = [];
            botRakipler = [];
            oyuncuSkorElement.textContent = 0;
            seviyeGostergeElement.textContent = 1;
            mesajElement.textContent = `BAŞLADI! Hayatta Kal...`;
            
            oyunDurumu = 'oynuyor';
            baslatDugmesi.textContent = "ARENA AKTİF";
            baslatDugmesi.disabled = true;
            
            oyunCevrimi(); 
        }

        function oyunuBitir(sebep) {
            oyunDurumu = 'bitti';
            baslatDugmesi.textContent = "TEKRAR DENE";
            baslatDugmesi.disabled = false;
            
            mesajElement.style.color = '#CF6679'; // Kırmızımsı
            mesajElement.innerHTML = `${sebep}<br>Nihai Skor: ${oyuncu.skor} | Seviye: ${zorlukSeviyesi}`;
        }
        
        baslatDugmesi.addEventListener('click', oyunuBaslat);

    </script>

</body>
</html>
